Utility kernels: prefix sum, compaction masks, validation
